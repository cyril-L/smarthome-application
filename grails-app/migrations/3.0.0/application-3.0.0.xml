<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.3.xsd">
    <changeSet author="Gregory (generated)" id="1570612051514-1">
        <createTable tableName="defi">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="actif" type="BOOL">
                <constraints nullable="false"/>
            </column>
            <column name="action_debut" type="TIMESTAMP WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="action_fin" type="TIMESTAMP WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="libelle" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="reference_debut" type="TIMESTAMP WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="reference_fin" type="TIMESTAMP WITHOUT TIME ZONE">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-2">
        <createTable tableName="defi_equipe">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="action_elec" type="FLOAT8"/>
            <column name="action_gaz" type="FLOAT8"/>
            <column name="defi_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="libelle" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="reference_elec" type="FLOAT8"/>
            <column name="reference_gaz" type="FLOAT8"/>
        </createTable>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-3">
        <createTable tableName="defi_participant">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="action_elec" type="FLOAT8"/>
            <column name="action_gaz" type="FLOAT8"/>
            <column name="defi_equipe_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="reference_elec" type="FLOAT8"/>
            <column name="reference_gaz" type="FLOAT8"/>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-4">
        <addColumn tableName="utilisateur">
            <column name="id" type="int8">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-5">
        <addPrimaryKey columnNames="id" constraintName="defi_equipe_pkey" tableName="defi_equipe"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-6">
        <addPrimaryKey columnNames="id" constraintName="defi_participant_pkey" tableName="defi_participant"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-7">
        <addPrimaryKey columnNames="id" constraintName="defi_pkey" tableName="defi"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-8">
        <addUniqueConstraint columnNames="libelle" constraintName="uk_b9ap722dj9uv34y31p67kepkh" deferrable="false" disabled="false" initiallyDeferred="false" tableName="defi"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-9">
        <addUniqueConstraint columnNames="user_id, defi_equipe_id" constraintName="unique_defi_equipe_id" deferrable="false" disabled="false" initiallyDeferred="false" tableName="defi_participant"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-10">
        <addUniqueConstraint columnNames="defi_id, libelle" constraintName="unique_libelle" deferrable="false" disabled="false" initiallyDeferred="false" tableName="defi_equipe"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-11">
        <addForeignKeyConstraint baseColumnNames="defi_equipe_id" baseTableName="defi_participant" constraintName="fk_3413qklvr4l5x05hni1wggumb" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="defi_equipe"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-12">
        <addForeignKeyConstraint baseColumnNames="user_id" baseTableName="defi_participant" constraintName="fk_h8iehl13qm6g9yb71y3exq1bs" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableCatalogName="smarthome" referencedTableName="utilisateur" referencedTableSchemaName="smarthome"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-13">
        <addForeignKeyConstraint baseColumnNames="user_id" baseTableName="defi" constraintName="fk_mp4r3wtkt2apjrtavo615uvfk" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableCatalogName="smarthome" referencedTableName="utilisateur" referencedTableSchemaName="smarthome"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-14">
        <addForeignKeyConstraint baseColumnNames="defi_id" baseTableName="defi_equipe" constraintName="fk_srs7shurfr54rdcfsdj3g3mbb" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="defi"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-15">
        <createIndex indexName="defi_idx" tableName="defi" unique="false">
            <column name="user_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-16">
        <createIndex indexName="defiequipe_idx" tableName="defi_equipe" unique="false">
            <column name="defi_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-17">
        <createIndex indexName="defiparticipant_idx" tableName="defi_participant" unique="false">
            <column name="defi_equipe_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1570612051514-18">
        <createIndex indexName="defiparticipant_user_idx" tableName="defi_participant" unique="false">
            <column name="user_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-1">
        <createTable tableName="defi_equipe_participant">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="action_electricite" type="FLOAT8"/>
            <column name="action_gaz" type="FLOAT8"/>
            <column name="classement_electricite" type="INT"/>
            <column name="classement_gaz" type="INT"/>
            <column name="classement_global" type="INT"/>
            <column name="defi_equipe_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="economie_electricite" type="FLOAT8"/>
            <column name="economie_gaz" type="FLOAT8"/>
            <column name="economie_global" type="FLOAT8"/>
            <column name="reference_electricite" type="FLOAT8"/>
            <column name="reference_gaz" type="FLOAT8"/>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-2">
        <createTable tableName="defi_equipe_profil">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="action_electricite" type="FLOAT8"/>
            <column name="action_gaz" type="FLOAT8"/>
            <column name="classement_electricite" type="INT"/>
            <column name="classement_gaz" type="INT"/>
            <column name="classement_global" type="INT"/>
            <column name="defi_equipe_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="economie_electricite" type="FLOAT8"/>
            <column name="economie_gaz" type="FLOAT8"/>
            <column name="economie_global" type="FLOAT8"/>
            <column name="profil_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="reference_electricite" type="FLOAT8"/>
            <column name="reference_gaz" type="FLOAT8"/>
        </createTable>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-3">
        <createTable tableName="defi_profil">
            <column name="id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="action_electricite" type="FLOAT8"/>
            <column name="action_gaz" type="FLOAT8"/>
            <column name="classement_electricite" type="INT"/>
            <column name="classement_gaz" type="INT"/>
            <column name="classement_global" type="INT"/>
            <column name="defi_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="economie_electricite" type="FLOAT8"/>
            <column name="economie_gaz" type="FLOAT8"/>
            <column name="economie_global" type="FLOAT8"/>
            <column name="profil_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="reference_electricite" type="FLOAT8"/>
            <column name="reference_gaz" type="FLOAT8"/>
        </createTable>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-4">
        <addColumn tableName="defi">
            <column name="action_electricite" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-5">
        <addColumn tableName="defi_equipe">
            <column name="action_electricite" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-6">
        <addColumn tableName="defi">
            <column name="action_gaz" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-7">
        <addColumn tableName="defi">
            <column name="classement_electricite" type="int4"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-8">
        <addColumn tableName="defi_equipe">
            <column name="classement_electricite" type="int4"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-9">
        <addColumn tableName="defi">
            <column name="classement_gaz" type="int4"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-10">
        <addColumn tableName="defi_equipe">
            <column name="classement_gaz" type="int4"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-11">
        <addColumn tableName="defi">
            <column name="classement_global" type="int4"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-12">
        <addColumn tableName="defi_equipe">
            <column name="classement_global" type="int4"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-13">
        <addColumn tableName="defi">
            <column name="economie_electricite" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-14">
        <addColumn tableName="defi_equipe">
            <column name="economie_electricite" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-15">
        <addColumn tableName="defi">
            <column name="economie_gaz" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-16">
        <addColumn tableName="defi_equipe">
            <column name="economie_gaz" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-17">
        <addColumn tableName="defi">
            <column name="economie_global" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-18">
        <addColumn tableName="defi_equipe">
            <column name="economie_global" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-19">
        <addColumn tableName="defi">
            <column name="reference_electricite" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-20">
        <addColumn tableName="defi_equipe">
            <column name="reference_electricite" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-21">
        <addColumn tableName="defi">
            <column name="reference_gaz" type="float8"/>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-22">
        <addColumn tableName="profil">
            <column name="id" type="int8">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-23">
        <addPrimaryKey columnNames="id" constraintName="defi_equipe_participant_pkey" tableName="defi_equipe_participant"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-24">
        <addPrimaryKey columnNames="id" constraintName="defi_equipe_profil_pkey" tableName="defi_equipe_profil"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-25">
        <addPrimaryKey columnNames="id" constraintName="defi_profil_pkey" tableName="defi_profil"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-26">
        <addUniqueConstraint columnNames="user_id, defi_equipe_id" constraintName="unique_defi_equipe_id" deferrable="false" disabled="false" initiallyDeferred="false" tableName="defi_equipe_participant"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-27">
        <addUniqueConstraint columnNames="profil_id, defi_id" constraintName="unique_defi_id" deferrable="false" disabled="false" initiallyDeferred="false" tableName="defi_profil"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-28">
        <addForeignKeyConstraint baseColumnNames="defi_equipe_id" baseTableName="defi_equipe_participant" constraintName="fk_4xhl6sbuct64v8k7op2byhu7g" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="defi_equipe"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-29">
        <addForeignKeyConstraint baseColumnNames="defi_equipe_id" baseTableName="defi_equipe_profil" constraintName="fk_54g6w5av2b6obj12srcwn2238" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="defi_equipe"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-30">
        <addForeignKeyConstraint baseColumnNames="profil_id" baseTableName="defi_profil" constraintName="fk_g9112pvhja8kf9faacx9q3kev" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableCatalogName="smarthome" referencedTableName="profil" referencedTableSchemaName="smarthome"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-31">
        <addForeignKeyConstraint baseColumnNames="user_id" baseTableName="defi_equipe_participant" constraintName="fk_ihk4fajkm4iytng1etrhd9d5d" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableCatalogName="smarthome" referencedTableName="utilisateur" referencedTableSchemaName="smarthome"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-32">
        <addForeignKeyConstraint baseColumnNames="defi_id" baseTableName="defi_profil" constraintName="fk_l80drwneeec5601o7mmyq7oa7" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="defi"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-33">
        <addForeignKeyConstraint baseColumnNames="profil_id" baseTableName="defi_equipe_profil" constraintName="fk_m4xmoshcibheec5vcpv7mmquf" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableCatalogName="smarthome" referencedTableName="profil" referencedTableSchemaName="smarthome"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-34">
        <createIndex indexName="defiequipeparticipant_idx" tableName="defi_equipe_participant" unique="false">
            <column name="defi_equipe_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-35">
        <createIndex indexName="defiequipeparticipant_user_idx" tableName="defi_equipe_participant" unique="false">
            <column name="user_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-36">
        <createIndex indexName="defiequipeprofil_idx" tableName="defi_equipe_profil" unique="false">
            <column name="defi_equipe_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-37">
        <createIndex indexName="defiprofil_idx" tableName="defi_profil" unique="false">
            <column name="defi_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-38">
        <dropForeignKeyConstraint baseTableName="defi_participant" constraintName="fk_3413qklvr4l5x05hni1wggumb"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-39">
        <dropForeignKeyConstraint baseTableName="defi_participant" constraintName="fk_h8iehl13qm6g9yb71y3exq1bs"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-40">
        <dropUniqueConstraint constraintName="unique_defi_equipe_id" tableName="defi_participant"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-41">
        <dropTable tableName="defi_participant"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-42">
        <dropColumn columnName="action_elec" tableName="defi_equipe"/>
    </changeSet>
    <changeSet author="Gregory (generated)" id="1571669185347-43">
        <dropColumn columnName="reference_elec" tableName="defi_equipe"/>
    </changeSet>
</databaseChangeLog>
